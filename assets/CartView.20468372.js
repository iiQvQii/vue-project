import{a5 as v,a as x,l as C,o as c,a6 as n,b as a,w as r,V as w,a7 as b,S as q,d as h,g as t,P as B,a8 as N,a9 as u,X as f,f as i,h as d,aa as S,ab as $,ac as D}from"./index.87ea4f99.js";import{V}from"./VDivider.cee1ed99.js";import{V as P}from"./VTable.26f248cf.js";const T={id:"cart"},z=t("h1",{class:"text-center"},"\u8CFC\u7269\u8ECA",-1),A=t("thead",null,[t("tr",null,[t("th",null,"\u5716\u7247"),t("th",null,"\u540D\u7A31"),t("th",null,"\u55AE\u50F9"),t("th",null,"\u6578\u91CF"),t("th",null,"\u5C0F\u8A08"),t("th",null,"\u64CD\u4F5C"),t("th",null,"\u5099\u8A3B")])],-1),E=d("-"),F=d("+"),I=d("\u522A\u9664"),L={key:0},R={key:1},U=t("td",{colspan:"6"},[t("h3",{class:"text-center"},"\u6C92\u6709\u5546\u54C1")],-1),X=[U],j=d("\u7D50\u5E33"),O={__name:"CartView",setup(G){const k=v(),l=x([]),m=C(()=>l.reduce((s,o)=>s+o.product.price*o.quantity,0)),g=C(()=>l.length>0&&!l.some(s=>!s.product.sell)),_=async(s,o)=>{await k.updateCart({product:l[s].product._id,quantity:o})&&(o===0?l.splice(s,1):l[s].quantity=o)};return(async()=>{try{const{data:s}=await b.get("/users/cart");l.push(...s.result)}catch{q.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(s,o)=>(c(),n("div",T,[a(w,null,{default:r(()=>[a(h,{cols:"12"},{default:r(()=>[z]),_:1}),a(V),a(h,{cols:"12"},{default:r(()=>[a(P,null,{default:r(()=>[A,t("tbody",null,[l.length>0?(c(!0),n(B,{key:0},N(l,(e,p)=>(c(),n("tr",{key:e._id,class:S({"text-red":!e.product.sell})},[t("td",null,[a($,{src:e.product.image},null,8,["src"])]),t("td",null,u(e.product.name),1),t("td",null,u(e.product.price),1),t("td",null,[a(i,{color:"primary",onClick:y=>_(p,e.quantity-1),variant:"text"},{default:r(()=>[E]),_:2},1032,["onClick"]),d(u(e.quantity),1),a(i,{color:"primary",onClick:y=>_(p,e.quantity+1),variant:"text"},{default:r(()=>[F]),_:2},1032,["onClick"])]),t("td",null,u(e.product.price*e.quantity),1),t("td",null,[a(i,{color:"primary",onClick:y=>_(p,0)},{default:r(()=>[I]),_:2},1032,["onClick"])]),e.product.sell?D("",!0):(c(),n("td",L,"\u6B64\u5546\u54C1\u5DF2\u4E0B\u67B6"))],2))),128)):(c(),n("tr",R,X))])]),_:1})]),_:1}),a(V),a(h,{class:"text-center",cols:"12"},{default:r(()=>[t("p",null,"\u7E3D\u91D1\u984D "+u(f(m)),1),a(i,{class:"mx-auto",color:"success",onClick:f(k).checkout,disabled:!f(g)},{default:r(()=>[j]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]))}};export{O as default};
